<!doctype html>
<html lang="en">
<html>
	<head>
<title>SST & MHW's</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
                <link rel="icon" href="../static/favicon.ico">
    <link rel="stylesheet" type="text/css" media='(min-width: 1024px)' href="../static/css/desktop-mhw.css?ref=v1" />
<link rel="stylesheet" href="../static/css/simplegrid.css" />
<link rel="stylesheet" href="../static/css/leaflet.css" />
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/leaflet.js"></script>
<link rel="stylesheet" href="../static/css/bootstrap.min.css">

	<style>

		#map {
		  height: 400px;
		  width: 100%;
		}

		.submit {
		    width: 120px;
		    font-size: 20px;
		    font-weight: bold;
		    margin-left: 40px;
		    margin-top: 10px;
		    color: #ff0000;
		    border-radius: 10px;
		    border-color: #ff0000;
		    border-width: 5px;
		}

		.radiobutton-label {
		    font-size: 15px;
		    font-weight: normal;
		}

		.checkbox-label {
		    font-size: 15px;
		    font-weight: normal;
		}

	</style>

<script type="text/javascript" src="../static/js/Leaflet.Coordinates-0.1.5.min.js"></script>
<script>

var marker = undefined;
var update_marker_location = function(){
    var newLatLng = new L.LatLng(parseFloat($("#latitude").val()),parseFloat($("#longitude").val()));
    marker.setLatLng(newLatLng); 
}

var greenIcon = L.icon({
    iconUrl: '../static/marker-icon.png',
    iconSize:     [38, 38],
    iconAnchor:   [19, 38],
});
	
var create_map = function(){
    map = L.map('map', {
		keyboard: false,
		dragging: false,
		zoomControl: false,
		boxZoom: false,
		doubleClickZoom: false,
		scrollWheelZoom: false,
		tap: false,
		touchZoom: false,
		zoom: 4.7,
		minZoom: 3.7,
		maxZoom: 4.7,
    center: [{{latitude}}, {{longitude}}]
    });
    var tiles = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
    }).addTo(map);
		marker = L.marker([{{latitude}}, {{longitude}}],   {icon: greenIcon},   {draggable: true}).addTo(map);
  marker.dragging.enable();
  marker.on('drag',function(e){
      $("#latitude").val(e.latlng.lat);
      $("#longitude").val(e.latlng.lng);
   });

  var model_polygon = L.polygon({{polygon}}, {fill: false, color:"#ff0000", weight: 1}).addTo(map);


  $("#latitude").change(update_marker_location);
  $("#longitude").change(update_marker_location);
   {% if shrink_domain %}
    var setShrinkDomain = function(bounds){
	    var northwest = bounds.getNorthWest();
	    var southeast = bounds.getSouthEast();
       $("#northwest_lat").val(northwest.lat);
       $("#northwest_lon").val(northwest.lng);
       $("#southeast_lat").val(southeast.lat);
       $("#southeast_lon").val(southeast.lng);
    }
    var areaSelect = L.areaSelect({width:map.getSize().x - 10, height: map.getSize().y - 10});
    areaSelect.on("change", function() {
     setShrinkDomain(this.getBounds());
    });
    areaSelect.addTo(map);
    setShrinkDomain(areaSelect.getBounds());
   {% endif %}
};

$(document).ready(function(){
    $("input:text").focus(function() { $(this).select(); } );
   create_map();
   $("#project_name").focus();
});

    function radioListener() {

        var lon = document.getElementById('longitude');
        var lat = document.getElementById('latitude');
        var rad = document.buoys.buoy;

        for (var i = 0; i < rad.length; i++) {
            rad[i].addEventListener('click', function() {
                   var coordinates = this.value.split(',');
                   lat.value = coordinates[0];
                   lon.value = coordinates[1];
    var newLatLng = new L.LatLng(parseFloat($("#latitude").val()),parseFloat($("#longitude").val()));
    marker.setLatLng(newLatLng); 
                                 });
        }

    }
</script>
</head>

<body onload="radioListener()">
	
	<div class="grid">
		<div class="col-1-2">
			<div class="content" style="height:400px">
                               <div id="map"></div>
			</div>
		</div>
		<div class="col-1-2"> <div class="content">


<form name="buoys">
	 
	         <p class="intro" >
		 Select a point on the map <b>or</b> use one of the shortcuts below. 
		    <b> Drag </b> the marker <b>or</b> enter the latitude and longitude coordinates.
		 </p>

  <input type="radio" id="Deenish Island" name="buoy" value="51.7431,-10.2122" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="Deenish Island">Deenish Island (51.7431ºN, 10.2122ºW)</label><br>

  <input type="radio" id="M2" name="buoy" value="53.4836,-5.4302" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="M2">M2 (53.4836ºN, 5.4302ºW)</label><br>

  <input type="radio" id="M3" name="buoy" value="51.2160,-10.5483" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="M3">M3 (51.2160ºN, 10.5483ºW)</label><br>

  <input type="radio" id="M4" name="buoy" value="55.0000,-9.9991" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="M4">M4 (55.0000ºN, 9.9991ºW)</label><br>

  <input type="radio" id="M5" name="buoy" value="51.6904,-6.7043" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="M5">M5 (51.6904ºN, 6.7043ºW)</label><br>

  <input type="radio" id="M6" name="buoy" value="53.0748,-15.88135" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="M6">M6 (53.0748ºN, 15.8813ºW)</label><br>

  <input type="radio" id="Mace Head" name="buoy" value="53.3306,-9.9326" onclick="javascript:radioListener();"/>
  <label class="radiobutton-label" for="Mace Head">Mace Head (53.3306ºN, 9.9326ºW)</label><br>

                    </form>

	         <p class="intro" >
		     Would you like to have Marine Heat Waves displayed?
		 </p>

		    <form method="POST" action="/his">

                            <input type="checkbox" id="MHW" name="MHW" value="MHW">
			    <label for="MHW" class="checkbox-label"> 
				    Show Marine Heat Waves </label> &emsp;
                            <input type="checkbox" id="CS" name="CS" value="CS">
			    <label for="CS" class="checkbox-label">
				    Show Cold Spells </label> <br>

	         <p class="intro" style="font-weight:bold;">
		     It may take up to 20 seconds to load the results...
		 </p>

	         <p class="intro" style="color:red; font-weight:bold;">
		     {{error}}
		 </p>

                </div>
                </div>
	</div>

	<div class="grid">
		<div class="col-1-4">
			<div class="content">
                                <input class="form-control" required type="number" size="20" step="any" id="latitude" name="latitude" value="{{latitude}}" >
			</div>
		</div>

		<div class="col-1-4">
			<div class="content">
                                <input class="form-control" required type="number" size="20" step="any" id="longitude" name="longitude" value="{{longitude}}" >
			</div>
		</div>
	</div>

        <div class="grid">
            
            <div class="col-5-12">
                <div class="content"></div>
            </div>

            <div class="col-1-6">
                <div class="content">
                       	<input class="submit" type="submit" value="Submit" name="submit" />
                </div>
            </div>

         </div>
		      </form>
	
	 <br>
   
</body>
</html>
